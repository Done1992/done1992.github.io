<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>PC-Konfigurator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background: #f0f0f5;
      color: #333;
    }

    .feldgruppe {
      background: #fff;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }

    select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    .preisfeld {
      font-size: 0.9em;
      color: #666;
      margin-top: 2px;
    }

    .gesamtpreis {
      font-size: 1.2em;
      font-weight: bold;
      color: #007700;
      margin-top: 30px;
    }

    #pdfBtn {
      padding: 10px 20px;
      background: #007700;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 20px;
    }
    
    @media (max-width: 600px) {
      body {
        margin: 10px;
      }

      h1 {
        font-size: 1.4em;
      }
    }
  </style>
</head>
<body>
  <h1>PC-Konfigurator</h1>

  <form id="konfiguratorForm">
    <div class="feldgruppe" id="felder">
      <!-- Dropdowns werden hier dynamisch eingefügt -->
    </div>

    <div class="gesamtpreis">Gesamtpreis: <span id="gesamt">0.00</span> €</div>
    <button type="button" id="pdfBtn">Konfiguration als PDF herunterladen</button>
  </form>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    const komponentenReihenfolge = [
      "hersteller", "cpu", "mainboard", "gehaeuse", "netzteil", "grafikkarte",
      "ram", "nvme", "luefter", "wlan", "os"
    ];

    const bezeichnungen = {
      hersteller: "Prozessorhersteller",
      cpu: "Prozessor",
      mainboard: "Mainboard",
      gehaeuse: "Gehäuse",
      netzteil: "Netzteil",
      grafikkarte: "Grafikkarte",
      ram: "Arbeitsspeicher (RAM)",
      nvme: "NVMe SSD",
      luefter: "Gehäuselüfter",
      wlan: "WLAN-Karte",
      os: "Betriebssystem"
    };

    let daten, preise = {}, auswahl = {};

    async function ladeDaten() {
      const res = await fetch('artikel.json');
      daten = await res.json();

      const container = document.getElementById("felder");

      komponentenReihenfolge.forEach(komponente => {
        const div = document.createElement("div");
        div.innerHTML = `
          <label for="${komponente}">${bezeichnungen[komponente]}:</label>
          <select id="${komponente}"></select>
          <div class="preisfeld" id="preis-${komponente}"></div>
        `;
        container.appendChild(div);
      });

      fuelleDropdowns();
    }

    function fuelleDropdowns() {
      komponentenReihenfolge.forEach(k => {
        const select = document.getElementById(k);
        const gruppe = daten[k] || [];
        select.innerHTML = "";

        gruppe.forEach(opt => {
          const option = new Option(`${opt.name} (${opt.preis} €)`, opt.id);
          if (opt.standard) option.selected = true;
          select.appendChild(option);
        });

        select.addEventListener("change", () => {
          const selected = gruppe.find(g => g.id === select.value);
          auswahl[k] = selected?.name || "";
          preise[k] = selected?.preis || 0;
          document.getElementById(`preis-${k}`).innerText = selected ? `Preis: ${selected.preis} €` : "";
          updateGesamtpreis();
        });

        const selected = gruppe.find(g => g.id === select.value || g.standard);
        auswahl[k] = selected?.name || "";
        preise[k] = selected?.preis || 0;
        document.getElementById(`preis-${k}`).innerText = selected ? `Preis: ${selected.preis} €` : "";
      });

      updateGesamtpreis();
    }

    function updateGesamtpreis() {
      const gesamt = Object.values(preise).reduce((a, b) => a + b, 0);
      document.getElementById("gesamt").innerText = gesamt.toFixed(2);
    }

    document.getElementById("pdfBtn").addEventListener("click", () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 10;
      doc.setFontSize(14);
      doc.text("Ihre PC-Konfiguration", 10, y);
      y += 10;

      <button type="button" id="saveBtn">Konfiguration speichern</button>
<button type="button" id="shareBtn">Teilen-Link kopieren</button>
<input type="text" id="shareUrl" readonly style="width:100%; margin-top:10px; display:none;">

      komponentenReihenfolge.forEach(k => {
        doc.setFontSize(12);
        doc.text(`${bezeichnungen[k]}: ${auswahl[k]} (${preise[k]} €)`, 10, y);
        y += 8;
      });

      doc.setFontSize(14);
      doc.text(`Gesamtpreis: ${Object.values(preise).reduce((a, b) => a + b, 0).toFixed(2)} €`, 10, y + 5);
      doc.save("pc-konfiguration.pdf");
    });

    ladeDaten();
  </script>
</body>
</html>
